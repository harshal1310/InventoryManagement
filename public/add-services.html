<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Services/Categories</title>
    <link rel="stylesheet" href="css/add-services.css">
    <link rel="stylesheet" href="css/sidebar.css">
    
</head>
<body>
    <aside class="sidebar">
        <h2>SUPER Laundry</h2>
        <ul>
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="customers.html">Customers</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="#">Reports</a></li>
            <li>
                <a href="#">Order</a>
                <div class="submenu">
                    <a href="create-order.html">Create Order</a>
                    <a href="view-orders.html">View Orders</a>
                </div>
            </li>
            <li>
                <a href="#">Purchase</a>
                <div class="submenu">
                    <a href="add-supplier.html">Add Supplier</a>
                    <a href="give-order.html">Give Order</a>
                    <a href="myorders.html">My Orders</a>
                </div>
            </li>
            </li>
        
            <li>
                <a href="#">Settings</a>
                <div class="submenu">
                    <a href="add-user.html">Manage Users</a>
                    <a href="add-services.html">Manage Services</a>
                    <a href="add-branches.html">Manage Branches</a>
                </div>
            </li>
            </li>
            <li><a href="#">Admin Details</a></li>
            <li><a href="#">Sigh Out</a></li>
        </ul>
    </aside>

    <div class="main-content">
        <h2>Add Services/Categories</h2>
        <form id="serviceForm">
            <input type="text" id="serviceName" placeholder="Service Name" required>
            <input type="text" id="serviceDescription" placeholder="Description" required>
            <input type="text" id="branch" placeholder="Branch Name" required>
            <button type="submit">Add Service/Category</button>
        </form>

        <table id="serviceTable">
            <thead>
                <tr>
                    <th>Service Name</th>
                    <th>Description</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <!-- Dummy data rows -->
                <tr>
                    <td>Washing</td>
                    <td>Standard Washing Service</td>
                    <td>
                        <button class="editBtn">Edit</button>
                        <button class="deleteBtn">Delete</button>
                    </td>
                </tr>
                <tr>
                    <td>Dry Cleaning</td>
                    <td>Professional Dry Cleaning</td>
                    <td>
                        <button class="editBtn">Edit</button>
                        <button class="deleteBtn">Delete</button>
                    </td>
                </tr>
                <!-- End dummy data -->
            </tbody>
        </table>
    </div>


    <div id="editCustomerModal" class="modal">
        <!-- Modal content here -->
        <span class="edit-close">&times;</span>
        <form id="editCustomerForm">
            <input type="hidden" id="edit-customer-id">
            <input type="text" id="edit-customer-name" placeholder="Name">
            <input type="text" id="edit-customer-address" placeholder="Address">
            <input type="text" id="edit-customer-city" placeholder="City">
            <input type="text" id="edit-contact-no1" placeholder="Mobile">
            <input type="date" id="edit-enrollment-date">
            <input type="text" id="edit-enrolled-by" placeholder="Enrolled By">
            <button type="submit">Update Customer</button>
        </form>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('serviceForm');
            const tableBody = document.querySelector('#serviceTable tbody');
            const editModal = document.getElementById('editModal');
            const editServiceNameInput = document.getElementById('editServiceName');
            const editServiceDescriptionInput = document.getElementById('editServiceDescription');
            const saveChangesBtn = document.getElementById('saveChangesBtn');

            form.addEventListener('submit', async function(event) {
                console.log("clock")
                event.preventDefault();

                const serviceName = document.getElementById('serviceName').value;
                const serviceDescription = document.getElementById('serviceDescription').value;
                const branchName = document.getElementById("branch").value

                if (serviceName.trim() === '' || serviceDescription.trim() === '' || branchName.trim === '') {
                    alert('Please fill in all fields.');
                    return;
                }

                try {
                    const response = await fetch('/api/manageService', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ serviceName, serviceDescription,branchName })
                    });

                    if (response.ok) {
                        const newRow = document.createElement('tr');
                        newRow.innerHTML = `
                            <td>${serviceName}</td>
                            <td>${serviceDescription}</td>
                            <td>
                                <button class="editBtn">Edit</button>
                                <button class="deleteBtn">Delete</button>
                            </td>
                        `;

                        const editBtn = newRow.querySelector('.editBtn');
                        editBtn.addEventListener('click', function() {
                            editServiceNameInput.value = newRow.cells[0].textContent;
                            editServiceDescriptionInput.value = newRow.cells[1].textContent;

                            editModal.style.display = 'block';

                            saveChangesBtn.onclick = function() {
                                newRow.cells[0].textContent = editServiceNameInput.value;
                                newRow.cells[1].textContent = editServiceDescriptionInput.value;

                                editModal.style.display = 'none';
                            };
                        });

                        const deleteBtn = newRow.querySelector('.deleteBtn');
                        deleteBtn.addEventListener('click', function() {
                            newRow.remove();
                        });

                        tableBody.appendChild(newRow);
                        form.reset();
                    } else {
                        alert('Failed to add service.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred while adding the service.');
                }
            });

            window.onclick = function(event) {
                if (event.target === editModal) {
                    editModal.style.display = 'none';
                }
            };

            document.querySelector('.close').onclick = function() {
                editModal.style.display = 'none';
            };
        });
    </script>
</body>
</html>
